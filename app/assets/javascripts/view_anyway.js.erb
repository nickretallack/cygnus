readyFunctions.push(function(){
  
});

readyFunctions.push(function(){
  var expandableFunc = function(image){
    image.addClass("materialboxed").materialbox();
    setInterval(function(){
      if($("#materialbox-overlay").length){
        image.parents(".expandable").css({
          zIndex: 1000
        });
      }else{
        image.parents(".expandable").css({
          zIndex: 0
        });
      }
    }, 50);
    return image;
  };

  $.each($(".expandable").find("img"), function(index, element){
    expandableFunc($(element));
  });

  var images = $(".adult");

  $.each(images, function(index, image){
    var image = $(image);
    var container = image.parents(".material-placeholder, .thumbnail"),
        cover = $("<div />", {
          class: "cover"
        }).css({
          backgroundColor: "rgba(47, 79, 79, .8)",
          position: "relative",
          color: "#D2FFC7",
          textShadow: "0px 0px 35px black"
        }).append($("<span />", {
          text: "View Anyway"
        }).css({
          cursor: "default",
          width: "100%",
          textAlign: "center"
        }).addClass("vc"));
    image.on("mouseenter", function(){
      container.append(cover.css({
        fontSize: image.width()/10,
        height: image.height(),
        width: image.width()
      }).on("click.view_anyway", function(event){
        pauseEvent(event);
        if(container.hasClass("thumbnail")){
          image.replaceWith($("<img />", {
            src: "/image/thumb/"+$(image).attr("id")
          }));
        }else{
          image.replaceWith(expandableFunc($("<img />", {
            src: "/image/full/"+$(image).attr("id")
          })));
        }
        $(this).trigger("mouseleave");
      })).on("mouseleave", function(){
        cover.remove();
      });
      if(container.hasClass("material-placeholder")){
        cover.css({
          marginTop: -image.height(),
          transform: "none"
        });
      }else{
        cover.css({
          top: "-100%",
          transform: "none"
        });
      }
      $(window).scroll(function(){
        container.trigger("mouseleave");
      });
      $(window).resize(function(){
        container.trigger("mouseleave");
      })
    });
  });
});