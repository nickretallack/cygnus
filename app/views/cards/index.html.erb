<% provide :header, link_to(@user.name, user_path(@user)) + "'s workboard" %>

<% if can_modify? @user %>
  <div class = "row hc js">
    <span>
      <%= content_tag :a, "View Mode", rel: :nofollow, class: "trigger" %>
      <div class = "vdiv"></div>
      <%= content_tag :a, "Edit Mode", rel: :nofollow, class: "trigger" %>
      <div class = "vdiv"></div>
      <%= content_tag :a, "Reorder Mode", rel: :nofollow, class: "trigger" %>
    </span>
  </div>
<% end %>
<div class = "row">
  <div class = "card top-card" id = <%= @top_card.id %> >
    <div class = "card-content">
      <div class = "card-title">
        <% if can_modify? @user %>
          <%= form_for @top_card, url: card_path(@user, @top_card), method: :patch do |f| %>
            <%= f.hidden_field :order, value: "" %> <!-- :order is not a property, only works if value is explicitly specified -->
            <div class = "js reorder-mode">
              <%= f.submit "Finalize Order" %>
            </div>
          <% end %>
          <div class = "edit-mode">
            <%= form_for @top_card, url: card_path(@user, @top_card), method: :patch, html: { class: "button-submit" } do |f| %>
              <%= f.submit "Create List", id: "create" %>
            <% end %>
            <div class = "button-area"></div>
          </div>
        <% else %>
          <div></div> <!--makes wrapping work on others' workboards-->
        <% end %>
          <% @lists.each do |list| %>
            <%= cell(:card, list).(:show, user: @user) %>
          <% end %>
      </div>
    </div>
  </div>
</div>