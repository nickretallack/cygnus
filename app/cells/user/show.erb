<%= form_for @user, url: update_user_path(@user), method: :patch, html: { multipart: true, class: " button-submit" } do |f| %>
  <div class = "row limit-height">
    <% if can_modify? @user %>
      <div class = "col s6 hc">
        <%= cell(:attachment, @user.avatar).(:new_image, explicit: (@user.avatar.explicit rescue false)) %>
      </div>
    <% else %>
      <div class = "col s6 preview">
        <%= cell(:image).(:limited, @user.avatar) %>
      </div>
    <% end %>
    <div class = "col s1 spacer"></div>
    <div class = "col s5">
      <%= cell(:user, @user).(:status, :verbose) %>
      <%= cell(:user, @user).(:links) unless can_modify? @user %>
    </div>
  </div>
  <div class = "row">
    <% if can_modify? @user %>
      <hr />
      <%= f.fields_for :artist_types do |t| %>
        <div class = "addable-field">
          <% unless @user.artist_types.length < 1 %>
            <% @user.artist_types.each_with_index do |type, index| %>
              <%= t.select "#{index}", options_for_select(CONFIG[:artist_types], type), { include_blank: "Artist Type" }, { class: "btn button-with-icon" } %>
            <% end %>
          <% else %>
            <%= t.select "0", options_for_select(CONFIG[:artist_types]), { include_blank: "Artist Type" }, { class: "btn button-with-icon" } %>
          <% end %>
        </div>
      <% end %>
      <div class ="addable-area"></div>
      <hr />
      <%= f.fields_for :offsite_galleries do |g| %>
        <div class = "addable-field">
          <% unless @user.offsite_galleries.length < 1 %>
            <% @user.offsite_galleries.each_with_index do |gallery, index| %>
              <%= g.text_field "#{index}", placeholder: "Offsite gallery", value: gallery %>
            <% end %>
          <% else %>
            <%= g.text_field "0", placeholder: "Offsite gallery", value: "" %>
          <% end %>
        </div>
      <% end %>
      <div class = "addable-area"></div>
      <hr />
      <%= f.text_area :price, placeholder: "Commission rates" %>
      <%= f.text_area :tags, placeholder: "Tags (comma-separated list)" %>
      <%= f.text_area :details, placeholder: "Profile Text" %>
      <%= f.submit "Update Profile", class: "float", id: "save" %>
    <% else %>
      <%= cell(:user, @user).(:attributes) %>
    <% end %>
  </div>
<% end %>
<div class = "button-area float-right"></div>
